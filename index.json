{"repository_name":"github.com/skippi/docspec","body":"# docspec\n\n[![Build Status](https://travis-ci.com/skippi/docspec.svg?branch=master)](https://travis-ci.com/skippi/docspec)\n[![Read the Docs (version)](https://img.shields.io/readthedocs/pip/stable.svg)](https://skippi.github.io/docspec/)\n\nA crystal library for automatically testing documentation examples.\n\nDocspec is crystal's equivalent of a doctest library.\n\n## Use Cases\n\n* Docspec integrates testing into your documentation.\n* Docspec encourages documentation due to integrated testing.\n* Docspec reduces boilerplate code for test cases.\n\n## Installation\n\nAdd this to your application's `shard.yml`:\n\n```yaml\ndependencies:\n  docspec:\n    github: skippi/docspec\n```\n\n## Usage\n\nSpecdoc parses source files for any commented codeblocks with code in them. For\neach codeblock line with a prefix of `>>`, it executes the line and stores the\nresult. If the line also had an expression appended with `# =>`, then specdoc\nwill test that the result equals the appended expression.\n\nIn this example, we will fully doctest `Foo.bar`, while ignoring doctesting for\n`Foo.echo`:\n\n```crystal\n# src/foo.cr\n\nmodule Foo\n  # Returns \"hello world\".\n  #\n  # ```\n  # >> Foo.bar # => \"hello world\"\n  #\n  # >> name = \"say #{Foo.bar}\"\n  # >> name # => \"say hello world\"\n  # ```\n  def self.bar\n    \"hello world\"\n  end\n\n  # Prints a string to stdout.\n  #\n  # ```\n  # Foo.echo(\"some text\")\n  #\n  # example_text = Foo.bar # => \"hello world\"\n  # Foo.echo(example_text)\n  # ```\n  def self.echo(string)\n    print(string)\n  end\nend\n```\n\nRequire docspec and doctest the source file:\n\n```crystal\n# spec/foo_spec.cr\n\nrequire \"docspec\"\n\nDocspec.doctest(\"src/foo.cr\")\n```\n\nLastly, run your tests in your project's root directory.\n\n```bash\ncrystal spec\n```\n\n## Documentation\n\n* [Official docs](https://skippi.github.io/docspec/)\n\n## Contributing\n\n1. Fork it ( [https://github.com/skippi/docspec/fork](https://github.com/skippi/docspec/fork) )\n2. Create your feature branch (git checkout -b my-new-feature)\n3. Commit your changes (git commit -am 'Add some feature')\n4. Push to the branch (git push origin my-new-feature)\n5. Create a new Pull Request\n\n## Contributors\n\n* [skippi](https://github.com/skippi)  - creator, maintainer\n","program":{"html_id":"github.com/skippi/docspec/toplevel","path":"toplevel.html","kind":"module","full_name":"Top Level Namespace","name":"Top Level Namespace","abstract":false,"superclass":null,"ancestors":[],"locations":[],"repository_name":"github.com/skippi/docspec","program":true,"enum":false,"alias":false,"aliased":"","const":false,"constants":[],"included_modules":[],"extended_modules":[],"subclasses":[],"including_types":[],"namespace":null,"doc":null,"summary":null,"class_methods":[],"constructors":[],"instance_methods":[],"macros":[],"types":[{"html_id":"github.com/skippi/docspec/Docspec","path":"Docspec.html","kind":"module","full_name":"Docspec","name":"Docspec","abstract":false,"superclass":null,"ancestors":[],"locations":[{"filename":"docspec/version.cr","line_number":1,"url":"https://github.com/skippi/docspec/blob/e2f9cbdcf50881bdaeb3ca6935577241e2802150/src/docspec/version.cr"},{"filename":"docspec.cr","line_number":3,"url":"https://github.com/skippi/docspec/blob/e2f9cbdcf50881bdaeb3ca6935577241e2802150/src/docspec.cr"}],"repository_name":"github.com/skippi/docspec","program":false,"enum":false,"alias":false,"aliased":"","const":false,"constants":[{"name":"DOCTEST_PREFIX","value":"/^>>/","doc":null,"summary":null},{"name":"DOCTEST_RESULT_PREFIX","value":"/# =>/","doc":null,"summary":null},{"name":"VERSION","value":"\"0.2.0\"","doc":null,"summary":null}],"included_modules":[],"extended_modules":[],"subclasses":[],"including_types":[],"namespace":null,"doc":null,"summary":null,"class_methods":[],"constructors":[],"instance_methods":[],"macros":[{"id":"doctest(filename)-macro","html_id":"doctest(filename)-macro","name":"doctest","doc":"Parses *filename* for marked examples to create specs.","summary":"<p>Parses <em>filename</em> for marked examples to create specs.</p>","abstract":false,"args":[{"name":"filename","doc":null,"default_value":"","external_name":"filename","restriction":""}],"args_string":"(filename)","source_link":"https://github.com/skippi/docspec/blob/e2f9cbdcf50881bdaeb3ca6935577241e2802150/src/docspec.cr#L8","def":{"name":"doctest","args":[{"name":"filename","doc":null,"default_value":"","external_name":"filename","restriction":""}],"double_splat":null,"splat_index":null,"block_arg":null,"visibility":"Public","body":"    \n{% calling_dir = filename.filename.gsub(/[^\\/]*$/, \"\") %}\n{% code_line? = false %}\n{% for line, index in (`cd #{calling_dir} && cat #{filename}`).lines %}{% if line.strip =~ (/^# ```/) %}{% code_line? = !code_line? %}{% else %}{% if line.strip =~ (/^#/) %}{% if code_line? %}Docspec.doctest_code_line({{ line.strip }}, {{ filename }}, {{ index + 1 }})\n        {% else %}Docspec.doctest_comment({{ line.strip }}, {{ filename }}, {{ index + 1 }})\n        {% end %}{% end %}{% end %}{% end %}\n"}}],"types":[]}]}}